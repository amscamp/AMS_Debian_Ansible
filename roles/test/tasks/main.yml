---


- name: Gather the package facts
  ansible.builtin.package_facts:
    manager: auto

# - name: Filter package names
#   set_fact:
#     filtered_package_names: "{{ ansible_facts.packages | list 
#       | map('regex_search', '^master-pdf-editor.*') | select('string') | list }}"




- ansible.builtin.set_fact:
    vvvmaster_pdf_editor: "{{ ansible_facts.packages[item] }}"
  loop: "{{ ansible_facts.packages.keys() | select('match', '^master-pdf-editor.*') | list }}"

# - debug:
#      var: ansible_facts


- name: Dump
  copy:
    content: "{{ hostvars[inventory_hostname] | to_nice_json }}"
    dest: /tmp/setup-dump.json

- name: Check whether a package called foobar is installed
  ansible.builtin.debug:
    # msg: "{{ ansible_facts.packages['foobar'] | length }} versions of foobar are installed!"
    msg: "beeee"
  when: ansible_facts.vvvmaster_pdf_editor is defined


# - name: determinate free-pdf-editor link
#   shell: echo "https://code-industry.net/public/$(curl -s https://code-industry.net/free-pdf-editor/ | grep -o 'master-pdf-editor-[0-9]*\.[0-9]*\.[0-9]*\-qt5.x86_64.deb' | head -1)"
#   register: tempurl

# - name: Install free-pdf-editor
#   apt: deb={{ tempurl.stdout }}


